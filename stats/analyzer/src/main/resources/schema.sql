DROP TABLE IF EXISTS USERS_ACTIONS CASCADE;
DROP TABLE IF EXISTS EVENTS_SIMILARITIES CASCADE;

CREATE TABLE IF NOT EXISTS USERS_ACTIONS
(
    USER_ACTION_ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    USER_ID BIGINT NOT NULL,
    EVENT_ID BIGINT NOT NULL,
    ACTION_TYPE VARCHAR(64),
    TIMESTAMP timestamp,

    CONSTRAINT USERS_ACTIONS_PK
        PRIMARY KEY (USER_ACTION_ID),
    CONSTRAINT USERS_ACTIONS_UNIQUE_USER_ID_EVENT_ID
        UNIQUE (USER_ID, EVENT_ID)
);

CREATE TABLE IF NOT EXISTS EVENTS_SIMILARITIES
(
    EVENT_SIMILARITY_ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    EVENT_A_ID BIGINT NOT NULL,
    EVENT_B_ID BIGINT NOT NULL,
    SCORE DOUBLE PRECISION NOT NULL,
    TIMESTAMP timestamp,

    CONSTRAINT EVENTS_SIMILARITIES_PK
        PRIMARY KEY (EVENT_SIMILARITY_ID),
    CONSTRAINT EVENTS_SIMILARITIES_UNIQUE_EVENT_A_EVENT_B
        UNIQUE (EVENT_A_ID, EVENT_B_ID)
)